See https://github.com/romanz/amodem for reference implementation (in Python).